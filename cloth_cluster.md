# Image Clustering based on Cloth


# 1. Recap

## 1.1 基本思路

目标是：
- 得到合适的聚类数量。
- 而且每个类中的图片看起来确实属于同一风格，减少类中误差。

## 1.2 完整方案

1. 去掉衣服占比太少的图：
    - 首先segment衣服，并计算出每个衣服的占比全图的面积。根据面积的分布情况，和segment后的识别能力，得到threshold为5%。因此去掉其中black area占比超过95%的图片（即衣服占比太少＜5%的图片都去掉）。
2. 计算聚类数目：
    - 对于剩下的图片进行cloth segment，并使用silhouette计算最佳聚类数目，根据silhouette的极值点，聚类最佳数目大致为6个。
3. 展示每个类别：
    - 整体分布情况展示。具体每个月的top5结果分布展示。检验是否合理。



# 2. 具体过程


## 2.1 去掉衣服占比太少的图


<p align="center">
    <img src="https://github.com/user-attachments/assets/9e685527-aa4e-43d4-9c36-10dc3228f19d" width="400" alt="去掉前的分布"/>
    <img src="https://github.com/user-attachments/assets/6dc61396-a458-40f6-ba4a-93cf9ffb68b8" width="400" alt="去掉后的分布"/>
    <br>
    <strong>Fig.1, 去掉衣服占比太少(＜5%)的图片，前后的分布对比。上一张图的最右端(横坐标占比大于0.95)被去除</strong>
</p>


<p align="center">
    <img src="https://github.com/user-attachments/assets/4473867c-78f7-4c92-885a-b0ec11cb198c" width=" " alt=" "/>
    <br>
    <strong>Fig.2, 可视化剩下图片。左边为segment图，右边为原图。可以看到即使是最下面一行，仍然可以显出足够的衣服形状</strong>
</p>


- 结论： 可以通过segment衣服，去掉无法识别cloth的bad case (找到的衣服threshold为小于5%)

## 2.2 计算聚类数目，使用silhouette轮廓法

- 去掉black area(衣服threshold小于5%)的图片后，对于剩下的图片继续做衣服segment，然后聚类。使用silhouette轮廓法找到聚类最佳数目/极大值点

<p align="center">
    <img src="https://github.com/user-attachments/assets/2839100f-4182-4f6f-a9dd-4ad4628f77db" width="800"/>
    <br>
    <strong>Fig.3, 使用【UMAP降维 + K-Means聚类】的silhouette整体曲线, k=6</strong> 
</p>

<p align="center">
    <img src="https://github.com/user-attachments/assets/596ccdc9-91e7-4c58-bf7e-dce654e3ef94" width="800"/>
    <br>
    <strong>Fig.4, 使用【UMAP + Agglomerative Clustering层次聚类】的silhouette曲线, k=2</strong>
</p>

## 2.3 可视化

- 下面的结果是使用silhouette得到的6类，来做聚类得到的category

### 2.3.1 19类图片类别及其对应高频关键词展示
- 文本处理说明: [tfashion.md](https://github.com/diandianyilin/fashion/blob/main/tfashion.md)
  
<p align="center">
    <img src="https://github.com/user-attachments/assets/34fd71c1-47de-4b9a-ab7e-1dce9411a637" width="800"/>
    <br>
    <strong>Fig.5_1, 显瘦: 1314; 牛仔裤: 1088; 秋冬: 959; 小个子: 708; 裤子: 626; 男生: 578; 微胖: 577; 身材: 552; 女生: 471; 希野逸儿: 428; 喇叭裤: 428; 外套: 416; 复古: 364; H: 356; plus: 347; 简单: 342; 黑色: 322; 简简单单: 320; 女孩: 310; 开春: 296; 耐看: 293; 大学生: 276; 适合: 273; 妹妹: 260; 期待: 260; 面试: 260; 通勤: 258; 骨架: 257; 秋天: 257; 感穿: 254; 推荐: 253; 白色: 243; 秋季: 243; 慵懒: 238; 舒服: 234; 羽绒服: 225; 我选: 214; 上衣: 213; 短袖: 211; 韩系: 211; 神裤: 206; 毛衣: 204; 冬季: 199; 美式: 198; 女儿: 195; 卫衣: 194; 牛仔: 193; 版型: 192; 夏天: 191; 保暖: 190; 风穿: 189; 百搭: 189; 衬衫: 187; look: 186; 浅浅的: 185; 休闲: 185; 上班: 184; 高个子: 176; 碎片: 176; 宽松:</strong>
</p>

<p align="center">
    <img src="https://github.com/user-attachments/assets/72c44323-00d2-43bd-ba44-953b237eb42c" width="800"/>
    <br>
    <strong>Fig.5_2, 裙子: 2080; 连衣裙: 1553; 女生: 1212; 长裙: 1141; 温柔: 997; 夏天: 789; 显瘦: 780; 高个子: 678; 感穿: 641; 中式: 604; 身材: 574; 设计: 554; 脚踝: 508; 夏日: 499; 小个子: 478; cmredexclamationmark: 464; 吊带裙: 444; 上身: 425; 微胖: 422; 秋冬: 413; doubleexclamationmark: 408; 姐妹: 385; 女孩: 370; 白色: 369; 适合: 369; 浪漫生活: 367; 高级: 363; 国风: 363; 秋天: 361; 复古: 346; 黑色: 310; 少女: 307; 约会: 307; 通勤: 276; look: 270; 套装: 268; Lolita: 265; moneybag: 262; 碎花: 256; 小众: 254; 面料: 252; 吊带: 233; butterfly: 232; 仙女: 231; 可爱: 231; 梨形: 228; 太太: 226; 时尚: 225; 这条: 223; 法式: 222; 推荐: 220; 韩系: 219; 风穿: 218; 鱼尾: 218; 一套: 218; 秋季: 208; hin: 202; 御姐: 194; 上班: 193; 版型: 193; redexclamationmark: 192; 粉色: 190; 小黑裙: </strong>
</p>

<p align="center">
    <img src="https://github.com/user-attachments/assets/44e2d935-aba1-4d7d-8acd-e355ef190f74" width="800"/>
    <br>
    <strong>Fig.5_3, 秋冬: 373; 小个子: 279; 显瘦: 254; 羽绒服: 220; 推荐: 197; keycap: 188; 韩系: 181; 身材: 156; 裤子: 153; 女生: 143; 通勤: 137; 合集: 134; 休闲: 128; 时髦: 126; 百搭: 126; 感穿: 124; 上身: 123; 企划: 122; 超会: 120; 冬季: 119; 时尚: 118; 高颜值: 118; 梨形: 116; 保暖: 114; 反季节: 111; 毛衣: 106; moneybag: 106; 外套: 101; 设计: 100; 复古: 100; 夏日: 99; look: 93; 简单: 86; 单品: 82; 舒适: 81; 大学生: 80; 版型: 80; 服装店: 80; 少女: 77; 特别: 77; 春夏: 76; 女孩: 75; 棉服: 75; 质感: 74; 牛仔裤: 74; doubleexclamationmark: 73; 姐妹: 73; 美式: 73; ins: 73; 夏天: 71; 拿下: 71; 学生: 71; 甜美: 70; 黑色: 70; 女装: 70; 搞笑: 70; 必备: 69; 白色: 69; 冬日: 67; 颜色: 67; 夏季: 65; 微胖: 64; 美洋: 63; 鸭绒: 62; 上衣: 61; 博主穿: 61; MEIYANG: 61; 适合: 60; 男生: 59; 衬衫: 58 </strong>
</p>

<p align="center">
    <img src="https://github.com/user-attachments/assets/fa8cb483-743c-4156-af42-1806e90365a0" width="800"/>
    <br>
    <strong>Fig.5_4, 小个子: 1275; 显瘦: 1030; 女生: 870; 秋冬: 712; 裙子: 643; 微胖: 541; 韩系: 475; 女孩: 422; 身材: 364; 毛衣: 353; 外套: 352; 大衣: 347; 通勤: 346; 上衣: 327; 辣妹: 300; 感穿: 291; 时尚: 288; 适合: 286; 上身: 278; 秋季: 276; 女装: 275; COOLbutton: 274; 复古: 270; 秋天: 269; 一套: 265; 温柔: 264; 服装店: 261; doubleexclamationmark: 245; 搞笑: 240; 推荐: 236; 夏天: 232; 黑色: 222; 慵懒: 216; 短袖: 214; 舒服: 206; 套装: 203; 短裙: 200; 上班: 187; 这件: 186; 简单: 185; 针织: 185; 浪漫生活: 185; 版型: 180; 姐妹: 178; 简简单单: 177; jk: 177; 针织衫: 176; 学院: 175; 夏日: 174; 美式: 172; 百搭: 171; 少女: 171; 高个子: 170; 牛仔: 166; look: 166; 一周: 166; 甜妹: 166; 风穿: 165; 衬衫: 164; 裤子: 164; 初秋: 162; 开衫: 160; 合集: 159; 面试: 156; 灰色 </strong>
</p>

<p align="center">
    <img src="https://github.com/user-attachments/assets/ee3cdcf1-e2f8-4171-a8e4-862db0650269" width="800"/>
    <br>
    <strong>Fig.5_5, 夏季: 279; 香云纱: 252; 白色: 240; 中式: 235; 夏天: 224; 新国潮: 221; 春夏: 219; 通勤: 219; 面料: 218; 衬衫: 216; 防晒: 212; 套装: 208; 职场: 207; 显白: 196; 出游: 182; 凉凉: 180; 一件: 161; 一套: 159; 轻薄: 158; 汉服: 154; 惊艳: 153; 吊带: 152; 不易: 134; 改良: 132; 穿进: 124; 第一次: 122; 感穿: 122; 粉色: 116; 适合: 112; 柔软: 101; 舒服: 101; 显瘦: 99; 高级: 98; 啊啊啊: 95; 淡淡的: 87; 洗过: 85; 品牌: 83; 慵懒: 81; 设计师: 81; 国风: 80; 裤子: 80; 鱼尾: 78; Amour: 76; 爱茉尔: 76; 韩好: 75; 绿色: 75; 神裤: 74; 上身: 65; 温柔: 62; 办公室: 62; 垂感: 61; yyds: 60; 带动: 56; 版型: 55; 好好看: 53; 透气: 53; 清爽: 53; 一人: 49; 身材: 49; 蓝色: 48; 推荐: 48; 这件: 47; 山本: 46; 一点: 45; 两件套: 43; 同色系: 41; 春季: 41; 小个子: 40; 梨形: 39; 干净: 39; 质感: 38; 几次: 37; 变形: 37; 凉快: 37; 外套: 37; 省事: 36; 小众: 36; 工人: 35; 海盐: 35; 颜色: 34; 饱和度: 34; 夏日: 32; 裤后: 32; YYDS: 30; 非遗: 30; 阔腿裤: 30; 春天: 29; 红云纱: 28; 姐妹: 28; 遮肉: 28; 配色: 28; 百搭: 28; 宽松: 27; 本来: 26; 阔腿 </strong>
</p>

<p align="center">
    <img src="https://github.com/user-attachments/assets/16485652-2503-4435-ae42-75b5b3abb2ca" width="800"/>
    <br>
    <strong>Fig.5_6, 秋冬: 832; 小个子: 769; 显瘦: 738; 裙子: 654; 女生: 513; 感穿: 460; 连衣裙: 428; 韩系: 416; 可爱: 361; 推荐: 336; 复古: 327; 大学生: 321; 黑色: 315; 毛衣: 310; 冬季: 306; 合集: 303; 女孩: 297; 辣妹: 288; 重样: 286; 秋天: 280; 高级: 278; 浪漫生活: 277; 适合: 271; 夏天: 268; 外套: 265; 姐妹: 259; 秋季: 257; 身材: 255; 少女: 254; 微胖: 249; 夏日: 235; 时髦: 233; 百搭: 230; 小众: 230; 通勤: 229; 时尚: 222; 大衣: 219; 裤子: 214; 设计: 208; 舒服: 201; 休闲: 200; 御姐: 199; 姿势: 198; 短发: 194; 温柔: 194; 卫衣: 193; 日系: 191; 碎片: 188; look: 188; 长裙: 179; 甜妹: 178; 慵懒: 172; 日本: 169; 白色: 166; 上衣: 166; 服装店: 164; keycap: 159; 宝宝: 159; 饰品: 157</strong>
</p>

